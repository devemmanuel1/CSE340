<%# The title is dynamically set from the controller %>
<% if (title) { %>
  <h1>
    <%= title %>
  </h1>
  <% } else { res.redirect('/') } %>

<%# Display flash messages and validation errors %> 
<%- messages() %>
<% if (errors) { const filtered=errors.array().filter(e=> e.msg !== 'Invalid value');
    if (filtered.length) { %>
    <ul class="flash-message notice">
        <% filtered.forEach(error=> { %>
            <li>
                <%= error.msg %>
            </li>
            <% }) %>
    </ul>
<% } } %>

<form id="updateInventoryForm" action="/inv/update" method="post">
  <fieldset>
    <div class="form-group">
      <label for="classificationList">Classification</label>
      <%- classificationSelect %>
    </div>
    <div class="form-group">
      <label for="inv_make">Make</label>
      <input
        type="text"
        id="inv_make"
        name="inv_make"
        required
        value="<%= locals.inv_make || '' %>"
      >
    </div>
    <div class="form-group">
      <label for="inv_model">Model</label>
      <input
        type="text"
        id="inv_model"
        name="inv_model"
        required
        value="<%= locals.inv_model || '' %>"
      >
    </div>
    <div class="form-group">
      <label for="inv_year">Year</label>
      <input
        type="number"
        id="inv_year"
        name="inv_year"
        required
        min="1900"
        max="2099"
        value="<%= locals.inv_year || '' %>"
      >
    </div>
    <div class="form-group">
      <label for="inv_description">Description</label>
      <textarea id="inv_description" name="inv_description" required>
<%= locals.inv_description || '' %></textarea
      >
    </div>
    <div class="form-group">
      <label for="inv_image">Image Path</label>
      <input
        type="text"
        id="inv_image"
        name="inv_image"
        required
        value="<%= locals.inv_image || '' %>"
      >
    </div>
    <div class="form-group">
      <label for="inv_thumbnail">Thumbnail Path</label>
      <input
        type="text"
        id="inv_thumbnail"
        name="inv_thumbnail"
        required
        value="<%= locals.inv_thumbnail || '' %>"
      >
    </div>
    <div class="form-group">
      <label for="inv_price">Price</label>
      <input
        type="number"
        id="inv_price"
        name="inv_price"
        required
        value="<%= locals.inv_price || '' %>"
      >
    </div>
    <div class="form-group">
      <label for="inv_miles">Miles</label>
      <input
        type="number"
        id="inv_miles"
        name="inv_miles"
        required
        value="<%= locals.inv_miles || '' %>"
      >
    </div>
    <div class="form-group">
      <label for="inv_color">Color</label>
      <input
        type="text"
        id="inv_color"
        name="inv_color"
        required
        value="<%= locals.inv_color || '' %>"
      >
    </div>

    <%# The button text is changed to "Update" %>
    <button type="submit" class="form-button" disabled>Update Vehicle</button>

    <%# IMPORTANT: Add a hidden input to send the inv_id with the form
    submission %>
    <input type="hidden" name="inv_id" <% if(locals.inv_id) { %> value="<%= locals.inv_id %>"
<% } %> >
  </fieldset>
</form>
<script src="../../js/inv-update.js"></script>